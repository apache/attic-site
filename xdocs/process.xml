<?xml version="1.0"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License. 
-->
<document>
  <properties>
    <author email="general.AT.attic.apache.DOT.org">The Apache Software Foundation</author>
    <title>Moving a project to the Attic</title>
  </properties>
<body>

<section id="moving">
  <title>Moving a project to the Attic</title>

  <p>At some point a project will vote to join the Attic. The following defines a process 
     to move that project into the Attic and gently close it down. </p>

  <ol>
    <li>A Project PMC decides to move to the Attic. 
      <ul>
        <li>Conduct a discussion on whether to dissolve the PMC and move the project to the Attic on the public dev list. Do not conduct it on the private PMC list. </li>
        <li>Consider an appeal to the user list for interested users to provide their interest in helping out more. </li>
        <li>Conduct a PMC vote on the public dev list. </li>
        <li>If the PMC votes to dissolve the PMC and move the project to the Attic, inform the board of the successful vote (linking or forwarding the 'successful' vote) and add a <a href="resolution.html">resolution</a> to dissolve the PMC to the next board meeting agenda. </li>
        <li>If the PMC can't get enough people to vote to dissolve the PMC (and there are not three -1 votes), then that is grounds for moving the project to the Attic. They should inform the board as above, noting that the vote failed to get enough votes. </li>
      </ul>
    </li>
    <li>If the board approve the resolution, open a JIRA item - 'Move ${project} to the Attic'.<br /> Copy/paste the following items to the details (see "How to" below for a description of each step): 
      <ol type="1">
        <li>Confirm Board Resolution (if TLP)</li>
        <li>Delete from committee-info.txt (if TLP)</li>
        <li>Remove VP entry on <a href="http://www.apache.org/foundation/">http://www.apache.org/foundation/</a> (if TLP)</li>
        <li>Inform users of the move to the Attic</li>
        <li>Create project page on Attic site: http://attic.apache.org/projects/${project}.html</li>
        <li>Obtain source control karma and point source control mails to general at attic
          <ul>
            <li>i. Update the project DOAP file (if any): https://projects.apache.org/project.html?${project}</li>
            <li>ii. Make source control read-only</li></ul></li>
        <li>Move committee's PMC data file to retired (if TLP)</li>
        <li>Remove from <a href="http://www.apache.org/#projects-list">http://www.apache.org/#projects-list</a> navigation (if TLP)</li>
        <li>Announce on <a href="http://mail-archives.apache.org/mod_mbox/www-announce/">announce at apache.org</a></li>
      </ol>
    </li>
    <li>Open an <a href="https://issues.apache.org/jira/browse/INFRA">Infrastructure JIRA</a> issue identifying the resources that need turning off/making read only. Typically:
      <ul>
        <li>Remove files from <a href="http://www.apache.org/dist/">www.apache.org/dist</a></li>
        <li>Closing down of dev@, commits@ and private@ <a href="http://mail-archives.apache.org/mod_mbox/">mailing lists</a></li>
        <li>Close down the user mailing list (unless still active - in which case propose a moderator to Infra)</li>
        <li>Make JIRA|Bugzilla read-only</li>
        <li>Make the wiki (Confluence|Moinmoin) read-only</li>
        <li>Delete unix/ldap group</li>
        <li>Turn off automated builds</li>
      </ul>
    </li>
  </ol>

</section>

<section id="General-pointers">
  <title>How to: General pointers</title>

  <p>The following are usefull svn/https locations:
    <ul>
     <li>svn site <a href="http://svn.apache.org/viewvc/attic">http://svn.apache.org/repos/asf/attic</a>: sources in <code>xdocs</code>, generated html in <code>docs</code></li>
     <li>site <a href="http://attic.apache.org">http://attic.apache.org</a></li>
     <li>internals: <a href="https://ci.apache.org/builders/attic-site">Buildbot job</a> to build from source and commit generated html,
         <a href="https://github.com/apache/infrastructure-puppet/blob/deployment/modules/svnwcsub/files/svnwcsub.conf#L36">svnwcsub configuration</a> to update generated html from svn to webserver</li>
     <li>jira <a href="https://issues.apache.org/jira/browse/ATTIC">https://issues.apache.org/jira/browse/ATTIC</a></li>
     <li>committees.xml <a href="https://svn.apache.org/repos/asf/comdev/projects.apache.org/data/committees.xml">https://svn.apache.org/repos/asf/comdev/projects.apache.org/data/committees.xml</a></li>
    </ul>
  </p>
</section>

<section id="confirm-resolution">
  <title>How to: 1. Confirm Board Resolution (if TLP)</title>
  <p>Check previous Board minutes (in SVN or to committers@) to confirm project was retired.</p>
</section>
  
<section id="delete-pmc">
  <title>How to: 2. Delete from committee-info.txt  (if TLP)</title>
  
  <p>Remove the PMC from <a href="https://svn.apache.org/repos/private/committers/board/committee-info.txt">https://svn.apache.org/repos/private/committers/board/committee-info.txt</a></p>
</section>

<section id="update-foundation-site">
  <title>How to: 3. Remove VP entry on http://www.apache.org/foundation/</title>
  <p>Access the CMS <a href="https://cms.apache.org/redirect?uri=http://www.apache.org/foundation/">here</a> 
  and update the text. </p>
  <p>Check if the outgoing PMC chair is not chair of any other PMCs, then ask infra to adjust the 'pmc-chairs' LDAP group accordingly.</p>
</section>

<section id="informing">
  <title>How to: 4. Inform users of the move to the Attic</title>

  <p>Let the users know that the project is moving into the Attic. Use the following template: </p>
  <pre>
A heads up for the ${project} user community that the ${project} project has 
been 'moved to the Attic'. This means that the ${project} developers (more 
formally its Project Management Committee) have voted to retire ${project} 
and move the responsibility for its oversight over to the Attic project.

Loosely speaking this means that the projects resources will be moved to a 
read-only state.

You can read more about the Apache Attic and the process of moving to the 
Attic at http://attic.apache.org.

You can follow this process in JIRA: 
 
  https://issues.apache.org/jira/browse/ATTIC-${#}

Thanks,

${Name} on behalf of ${project} + the Attic.
  </pre>

  <p>Remember to subscribe to the user list <a href="https://whimsy.apache.org/committers/subscribe">https://whimsy.apache.org/committers/subscribe</a> to avoid moderation. Also bear in mind that the user mailing list may 
     already know and you can skip this stage. Make sure you read that thread if it does exist. </p>
</section>

<section id="atticsite">
  <title>How to: 5. Create project page on Attic site: http://attic.apache.org/projects/${project}.html</title>

  <p>The Attic website is built using Anakia. Anakia is an old site technology built on top of Apache Velocity. 
     You can get the source for the site from Subversion: </p>
  <pre>svn co https://svn.apache.org/repos/asf/attic/site</pre>

  <p>Signal that <i>retired</i> banners must be added to ${project}.a.o. :</p>
  <ul>
    <li><code>mkdir xdocs/flagged/${project}.apache.org ;</code></li>
    <li><code>touch xdocs/flagged/${project}.apache.org/${project}.apache.org</code></li>
  </ul>

  <p>To create a project page do:</p>

  <ul>
    <li>in xdocs/projects/ copy one of the files to the new project name (eg. devicemap.xml)</li>
    <li>TBA: how to determine the file name</li>
    <li>Add the new file as a link in the xdocs/stylesheets/project.xml navigation</li>
    <li>Run 'ant' from the root (ie: the attic/site/ directory you checked out)</li>
    <li>Review the generated files in docs/** in your browser</li>
    <li>SVN commit *all* changes. Remember to add both the new xdocs/ project file and the new generated docs/ project file
    </li>
    <li>The new pages should go live quickly</li>
  </ul>

  <p>To make minor edits to existing pages:</p>
  <ul>
    <li>edit the page(s)</li>
    <li>Commit the updated pages</li>
    <li>The buildbot will build the site and commit the result which will be published soon after</li>
    <li>This is most suitable for minor changes when there is no need to review the output before committing.
    Otherwise use the process described previously.
    </li>
  </ul>

</section>

<section id="svnkarma">
    <title>How to: 6. Obtain source control karma and point source control mails to general at attic</title>

    <p>follow the workflow <a href="https://cwiki.apache.org/confluence/display/INFRA/Git+workflow+for+infrastructure-puppet+repo">https://cwiki.apache.org/confluence/display/INFRA/Git+workflow+for+infrastructure-puppet+repo</a>,<br />
sometimes it helps chatting with infra <a href="https://www.hipchat.com/gIjVtYcNy">https://www.hipchat.com/gIjVtYcNy</a>,<br />
all work are done in "{infra-repo}/modules/subversion_server/files/authorization/"</p>
    <ul>
        <li>Change "asf-authorization-template" so that the attic-pmc has karma instead of the defunct project. </li>
        <li>Change "asf-mailer.conf" so that the attic-pmc has karma instead of the defunct project. Add project to attic regex, and if there are a project entry remove it</li>
    </ul>
</section>

<section id="doap">
    <title>How to: 6.ii Update the project DOAP file (if any): https://projects.apache.org/project.html?${project}</title>

    <p>The files referenced are in <a href="https://svn.apache.org/repos/asf/comdev">https://svn.apache.org/repos/asf/comdev</a></p>

    <p>Identify whether the project has a DOAP file (see the &lt;comdev repo&gt;/projects.apache.org/data/projects.xml file if update the rdf file with PMC to the Attic and add a category of <em>retired</em>: </p>
     <pre>pmc change:    &lt;asfext:pmc rdf:resource="http://attic.apache.org" /&gt;
new category:  &lt;category rdf:resource="http://projects.apache.org/category/retired" /&gt;</pre>
</section>

<section id="PMCdata">
    <title>How to: 7. Move committee's PMC data file to retired (if TLP)</title>

    <p>If committee appears in <a href="https://projects.apache.org/committees.html">committees list</a>, moving data to retired will remove it from the list.
       Notice that <a href="https://issues.apache.org/jira/browse/COMDEV-182">this task is being automated</a>, then not necessary to track any more in the future...</p>
    <p>Comment PMC data files index entry (see the <a href="https://svn.apache.org/repos/asf/comdev/projects.apache.org/data/committees.xml">committees.xml</a> file
       and old <a href="https://svn.apache.org/repos/asf/infrastructure/site-tools/trunk/projects/pmc_list.xml">pmc_list.xml</a> file) and move PMC data file
       from <a href="https://svn.apache.org/repos/asf/comdev/projects.apache.org/data/committees">committees/</a> directory
       to <a href="https://svn.apache.org/repos/asf/comdev/projects.apache.org/data/committees-retired">committees-retired/</a>.
    </p>
</section>

<section id="www.apache">
  <title>How to: 8. Remove from http://www.apache.org/#projects-list navigation (if TLP)</title>

  <p>As a retired project, a <a href="http://www.apache.org/#projects-list">link on the front page of Apache site</a> is no longer necessary. Remove the link and regenerate the main Apache site. 
     This is done via the <code>trunk/templates/blocks/projects.mdtext</code> of the <a href="https://cms.apache.org/redirect?uri=http://www.apache.org/index.html">www.apache.org CMS</a>. </p>

  <p>It's also worth checking that the VP link from <a href="http://www.apache.org/foundation/">http://www.apache.org/foundation/</a> has been removed. </p>
</section>

<section id="announce">
  <title>How to: 9. Announce on announce@apache.org</title>

  <p>Announce that the project is now retired. Consider the following template. </p>

  <pre>
Announcing that the Apache ${project} committers have voted to retire
the project due to inactivity. ${project} was {boilerplate}.

Retiring a project is not as simple as turning everything off, as
existing users need to both know that the project is retiring and
retain access to the necessary information for their own development
efforts.

You can read more about ${project}'s retirement at:

   http://attic.apache.org/projects/${project}.html

The user mailing list remains open, while the rest of the project's
resources will continue to be available in a read-only state -
website, wikis, svn, downloads and bug tracker with no change in url.

Providing process and solutions to make it clear when an Apache
project has reached its end of life is the role of the Apache Attic,
and you can read more about that at:

   http://attic.apache.org/

Thanks,

${NAME}
on behalf of the Apache Attic and the now retired Apache ${project} project
  </pre>

  <p>It's important to include the boilerplate from the project's site so people 
     know what we're talking about. </p>
</section>

</body>
</document>
